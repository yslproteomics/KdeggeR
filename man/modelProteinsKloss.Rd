% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/modelProteinsKloss.R
\name{modelProteinsKloss}
\alias{modelProteinsKloss}
\title{Calculate All Protein k_loss by Fitting All Peptides on a Single Model}
\usage{
modelProteinsKloss(
  o,
  method = "combined",
  ag.weights = "variance",
  unique.weights = TRUE,
  in.all = 2,
  removeOutliers = 5,
  ncores = NULL,
  tryRobust = FALSE,
  returnKlossTableOnly = FALSE,
  freeIntersect = FALSE,
  returnSD = FALSE
)
}
\arguments{
\item{o}{A `pSILAC` object containing peptide-level k_loss data for each protein.}

\item{method}{Character string specifying the method used for calculating protein-level rates. Options are `"RIA"`, `"hol"`, or `"combined"` (default), which combines both RIA- and H/L-based peptide k_loss values.}

\item{ag.weights}{Character string specifying the method to calculate weights for the weighted mean. Default is `"variance"`, which uses the inverse variance of the model's fit. Other options include `"nbpoints"` (based on the number of datapoints used for the fit) and `"both"` (combining both datapoint count and variance). Ignored if `ag.metric` is not set to `"mean"`.}

\item{unique.weights}{Logical; if `TRUE` (default), unique weights are used for each peptide. If `FALSE`, weights are calculated individually for each sample.}

\item{in.all}{Numeric or logical, specifying the minimum number of peptides that must be quantified in all samples for inclusion. Default is `2`. Set to `FALSE` to use all peptides, regardless of sample quantification.}

\item{removeOutliers}{Numeric or logical, specifying the threshold for removing outlier peptides. If a numeric value (default is `5`), outliers are removed based on this threshold. Set to `FALSE` to disable outlier removal. See `?removeOutlierPeptides` for details.}

\item{ncores}{Numeric, specifying the number of cores to use for parallel processing (default is all available cores minus one).}

\item{tryRobust}{Logical; if `TRUE`, attempts to fit a robust linear model when modeling based on the H/L ratio. Requires the `MASS` library. Default is `FALSE`.}

\item{returnKlossTableOnly}{Logical; if `TRUE`, returns only the k_loss table instead of the full `pSILAC` object. Default is `FALSE`.}

\item{freeIntersect}{Logical; if `TRUE`, also fits the intercept when using the NLI-based method.}

\item{returnSD}{Logical; if `TRUE`, includes the standard deviation (SD) of the k_loss in the output. Default is `FALSE`.}
}
\value{
If `returnKlossTableOnly` is `FALSE` (default), returns the updated `pSILAC` object with the added protein-level k_loss table. If `returnKlossTableOnly` is `TRUE`, returns only the protein k_loss table as a data frame.
}
\description{
This function aggregates peptide-level k_loss values to calculate protein-level rates by fitting all peptides 
associated with each protein into a single model. It requires that `calcRIAkloss()` and/or `calcHoLkloss()` 
have been run first to generate peptide k_loss values.
}
\details{
This function calculates protein-level k_loss by aggregating peptide-level values, using the specified method (`"RIA"`, `"hol"`, or `"combined"`). The weighting method for aggregation can be specified, allowing flexibility in how the final protein k_loss rate is calculated. Peptides can be filtered based on the `in.all` criterion (number of samples with quantification) and by removing outliers if `removeOutliers` is enabled.
}
